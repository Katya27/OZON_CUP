# Проект

##  Описание задачи

Разработать ML-модель, которая будет определять на фото в карточке товара на сайте ozon.ru:
- Табачную продукцию,
- Устройства для потребления никотиносодержащей продукции,
- Репрезентующие форму сигареты или трубки для табака курительной, и отмечать такие карточки товара как содержащие запрещенный для использования в карточках товара Контент.
Модель должна найти среди представленного Контента как можно больше Контента, где отображается указанный запрещенный для использования в карточках товара Контент с долей точности > 95%.

##  Результаты

Этот проект включает в себя код для классификации изображений с использованием модели EfficientNet B1. Модель обучена на наборе данных, содержащем 5 классов изображений.

В результате удалось добиться 
- Precision: 0.94
- Recall: 0.96
- F1-Score: 0.95
на тестовых данных.

##  Запуск

##### Склонируйте репозиторий
```
git clone git@github.com:Katya27/OZON_CUP.git
```

##### Обучающие данные
Данные находятся в папке /data.
Обучающие данные находятся в папке /data/train, валидационные данные - в папке /data/val, тестовые данные - в папке /data/test.
Файл с метками классов для тренировочной выборки находится data/private_info/train.csv.

##### Соберите образ решения
```shell
docker build . -t moderatsiya_kartochek
```

##### Запустите baseline.py
```shell
docker run -it --network none --shm-size 2G --name moderatsiya_kartochek -v ./data:/app/data moderatsiya_kartochek python baseline.py
```
Эта команда обучит модель на изображениях в data/train. В результате выполнения в корне проекта (в контейнере) появится файл с весами модели baseline.pt. Скопируйте его в локальную систему для дальнейшей работы.
```shell
docker cp template_5706:/app/baseline.pt ./
```

#### Отладка

Проверка на тестовых данных.
##### Запустите инференс make submission py
```shell
docker run -it --network none --shm-size 2G --name moderatsiya_kartochek -v ./data:/app/data moderatsiya_kartochek python make_submission.py
```
По итогу выполнения команды, файл с решением `submission.csv` появится в папке `data`. Проверьте его на правильность структуры. При желании, можете запустить расчет метрики на нем. Пример файла с расчетом метрики находится в репозитории.
